## Содержание:

1. [Пояснительная записка](#explanatory_note)
2. [Техническое задание](#terms_of_reference)
3. [Ссылки](#links)

## <h2 id="explanatory_note">Пояснительная записка</h2>
### Название проекта

**Вешенбург.**

### Авторы проекта:
* Цориева Ева
* Габисов Макисм

### Аннотация
Интернет-магазин с управлением товарами, заказами и промокодами. Поддержка самовывоза по QR-коду, оплаты наличными/переводом, отслеживания использования скидочных кодов.

### Функционал: [ссылка на эллемент в ТЗ](#functional)

### Руководство администратора
Установить Python 3.11, зависимости программа установит сама, или выполните в корне проекта:
```commandline
pip install -r Misc/requirements.txt
```
Нужные папки программа создаст сама. \
Для запуска программы откройте файл server.py а корне проекта. \
Для завершения работы сервера напишите в консоль команду:
```commandline
shutdown
```

### Руководство пользователя
[скачать](https://github.com/maxxximgb/magaz/raw/refs/heads/main/Documents/%D0%A0%D1%83%D0%BA%D0%BE%D0%B2%D0%BE%D0%B4%D1%81%D1%82%D0%B2%D0%BE%20%D0%BF%D0%BE%D0%BB%D1%8C%D0%B7%D0%BE%D0%B2%D0%B0%D1%82%D0%B5%D0%BB%D1%8F.docx) или [google docs](https://docs.google.com/document/d/1qvTi5jt5i6Lr2NXNdFikumM584Df-kiPTz_1oJNxGNE/edit?usp=sharing)

### Руководство пргораммиста
Для реализации серверной части созданы модули:

1. [Blueprints/UserAPI.py](/Blueprints/UserAPI.py) -  Пользовательское API:
    * Содержит:
        1. bpUserApi - Blueprint UserAPI.
        2. getCatalog - Функция для получения всех, доступных пользователю продуктов.
        3. getProduct - Функция для получения подробной информации о продукте по его ID.
        4. buy - Функция, которая возвращает страницу с информацией о продукте.
    * Использует:
        1. flask - для создания blueprint и взаимодействия с ним, проверки сессии, ответов на запросы.
        2. Database.Classes.Product - для получения продуктов в БД.
        3. Misc.Templates - для получения шаблонов страниц и их рендера.
        4. Database.Engine.Engine - для создания сессии БД.
2. [Blueprints/AdminApi.py](/Blueprints/AdminAPI.py) - API для администраторов:
    * Содержит:
        1. bpAdminApi - Blueprint AdminAPI.
        2. getOrders - Функция для получения всех существующих заказов.
        3. getCatalog - Функция для получения всех продуктов, в том числе недоступных для пользователя.
        4. catalog - Функция, которая возвращает страницу каталога с возможностью редактирования.
        5. newProduct - Функция для добавления продукта в БД.
        6. dashboard - Функция, которая возвращает страницу "Панель управления".
    * Использует:
        1. flask - для создания blueprint и взаимодействия с ним, проверки сессии, ответов на запросы и переадресаций.
        2. Database.Classes.Order - для создания заказов в БД. 
        3. Database.Classes.Product - для создания продуктов в БД.
        4. Misc.Templates - для получения шаблонов страниц и их рендера.
        5. Database.Engine.Engine - для создания сессии БД.
3. [Database/Classes](/Database/Classes) - Классы для sqlalchemy:
    * Содержит:
        1. [Admin.py](/Database/Classes/Admin.py) - Класс, содержащий информацию об администраторе.
        2. [Order.py](/Database/Classes/Order.py) - Класс, содержащий информацию о заказе.
        3. [Product.py](/Database/Classes/Product.py) - Класс, содержащий информацию о продукте.
        4. [Promocode.py](/Database/Classes/Promocode.py) - Класс, содержащий информацию о промокоде.
    * Использует:
        1. sqlalchemy - для обьявлений ячеек таблицы и их типов данных.
        2. Database.Engine.Engine - для получения обьявленной БД.
4. [Database/Engine](/Database/Engine) - Модуль для создания сессий БД:
    * Содержит:
        1. global_init  Функция для инициализации sqlalchemy.
        2. create_session - Функция для создания сессии БД.
    * Использует:
        1. sqlalchemy - для инициализации и создания сессий.
5. [Misc/Console.py](/Misc/Console.py) - Модуль интерфейса консоли:
    * Содержит:
        1. clear_console - Функция для очистки консоли после ввода пароля для безопасности.
        2. parse_args - Функция для парсинга аргументов в консоли.
        3. verifyPassword - Функция для проверки надёжности пароля при регистрации администратора.
        4. consoleHelp - Функция для вывода списка доступных команд в консоль.
        5. consoleRegister - Функция для регистрации администратора в БД.
        6. consoleView - Функция для просмотра всех пользователей выбранной должности.
        7. shutdown - Функция для завершения работы сервера.
        8. consoleLook - Функция для поиска администраторов в БД с указанными параметрами.
        9. runHook - Функция для переадресации вывода flask в файл, вместо консоли.
        10. setHook - Функция для установки перехвата функции запуска приложения flask на runHook.
        11. ConsoleWorker - Функция для работы потока консоли.
        12. cmds - Словарь, который связывает консольные команды с функциями.
    * Использует:
        1. datetime - Для получения текущего времени при регистрации администраторов.
        2. logging - Для включения логгирования в файл.
        3. os - Для очистки консоли.
        4. sys - Для получения загруженных в текущий модуль модулей для проверки при регистрации, существует ли должность в БД.
        5. time - Для того чтобы не нагружать процессор при ожидании запуска приложения.
        6. types - Для того чтобы сделать unbound функцию bound для установки хука.
        7. werkzeug - Для хеширования пароля.
        8. Database.Engine.Engine - для создания сессии БД.
        9. Database.Classes.Admin - для регистрации администраторов.
6. [Misc/Setup.py](/Misc/Setup.py) - Модуль для установки отсутствующих зависимостей:
    * Содержит:
        1. RequirementsInstaller - Класс, отвечающий за установку зависимостей.
        2. install - Функция для проверки и установки отсутствующих зависимостей.
    * Использует:
        1. os - для очистки консоли.
        2. urllib - для проверки доступности PYPI.
        3. pathlib - для получения пути к requirements.txt.
        4. pip - для установки отсутствующих зависимостей.
        5. pkg_resources - для парсинга списка зависимостей.
7. [Misc/Templates.py](/Misc/Templates.py) - Модуль, содержащий данные для шаблонов по умолчанию:
    * Содержит:
        1. Template - Класс, содержащий информацию о шаблоне.
        2. Инициализированные классы Template с информацией о соответствующих шаблонах.
    * Использует:
        1. flask - для рендера шаблонов.
8. [server.py](/server.py) - Главный модуль серверной части:
    * Содержит:
        1. app - Главное приложение Flask.
        2. before_request и after_request - для подсчета количества текущих запросов.
        3. login - Функция для рендера и обработки формы авторизации.
        4. logout - Функция для выхода из аккаунта администратора.
    * Использует:
        1. flask - для подключения blueprint, проверки сессии, ответов на запросы и переадресаций.
        2. threading - для создания потока консоли.
        3. werkzeug - для проверки паролей.
        4. Misc.Console - для установки хуков и запуска потока консоли.
        5. Misc.Templates - для получения шаблонов страниц и их рендера.
        6. Blueprints.AdminAPI и Blueprints.UserAPI - для дальнейшего подключения.
        7. Database.Classes.Admin - для получения администраторов из БД.
        8. Database.Engine.Engine - для создания сессии БД. 

### Заключение

Было задумано довольно много функционала, но удалось реализовать достаточно для работы и использования сервера. Мы многому научились во время работы над этим проектом и не планируем останавливаться. Проект продолжит развиваться, функционал, описанный в техническом задании будет реализован и внедрен в приложение.

## <h2 id="terms_of_reference">Техническое задание</h2>
### Назначение разработки:
Интернет-магазин для оптимизации продаж продукции. Владелец может добавлять товары, указывая название, фотографию, цену, вес. Для заказа клиенты указывают ФИО, телефон, выбирают способ оплаты. Промокоды создаются с управляемыми скидками, их можно редактировать или отключать. QR-коды и номера заказов ускоряют выдачу при самовывозе. Пользователи активируют промокоды на этапе оформления, чтобы снизить стоимость. Администратор отслеживает, сколько раз промокод использовали. Карта с адресом пункта выдачи и контактами — на сайте.

### Целевая аудитория:  
* Владелец бизнеса. 
* Люди находящиеся на территории СКФО в возрасте от 18 лет. 


### <h3 id="functional">Функционал пользователей:</h3>  

* Администратор (владелец бизнеса):
  1. Ручное добавление информации о товаре, а именно:
     1. Название товара.
     2. Фотографию товара.
     3. Минимальный вес товара.
     4. Цена товара за минимальный вес.
     5. Будет ли пользователям видно товар после создания.
  2. Предпросмотр информации о заказах, а именно:
     1. Информация о заказчике: его ФИО и контактный номер.
     2. Название заказанных товаров.
     3. Цена заказа, скидка в процентах, если использован промокод.
  3. Полный просмотр информации о конкретном заказе, а именно:
     1. Информация о заказчике: его ФИО и контактный номер.
     2. Подробная информация о заказанных товарах, а именно:
        1. Название товара.
        2. Заказанный вес товара.
        3. Цена товара.
     3. Время, когда был создан заказ.
     4. Оригинальная цена заказа и цена заказа с учетом скидок, если они есть.
     5. Номер заказа.
  4. Создание промокодов на скидку, указывая при этом:
     1. Промокод.
     2. Скидка в процентах, которую он дает.
     3. Будет ли работать промокод на момент его создания.
  5. Предпросмотр информации о промокодах, а именно:
     1. Строка, содержащая промокод.
     2. Скидка в процентах, которую он дает.
     3. Количество пользователей, которые его активировали.
     4. Работает ли промокод.
  6. Взаимодействие с промокодами на скидку, с возможностями:
     1. Редактирования промокода.
     2. Редактирования процента скидки, которую он делает.
     3. Удаления или временного отключения промокода.
  7. Дополнительный функционал.
     1. Сканирование QR кода, сгенерированного при заказе и переход к соотв. заказу.
     2. Поиск заказа по номеру, сгенерированного при заказе и переход к соотв. заказу
* Пользователи/покупатели сайта
  1. Просмотр каталога товаров, а именно:
     1. Просмотр изображения товара.
     2. Просмотр цены за 1 кг. товара.
     3. Добавление товара в корзину, указывая при этом:
        1. Вес 1 нужной упаковки товара.
        2. Количество таких упаковок.
  2. Просмотр корзины с товарами, а именно:
     1. Просмотр информации о заказанных товарах, а именно:
        1. Фотография товара.
        2. Выбранный вес тары товара.
        3. Количество нужных упаковок по выбранному весу.
        4. Настоящая цена за килограмм.
        5. Итоговая стоимость товара.
     2. Ввод промокода на скидку.
     3. Оформление заказа
  3. Оформление заказа:
     * Информация, которую необходимо указать:
       1. ФИО.
       2. Контактный номер телефона.
       3. Способ оплаты.
     * Информация, сгенерированная после подтверждения оформления заказа:
       1. Номер заказа.
       2. QR-код заказа.
  4. Просмотр контактов продавца, пункта выдачи на карте.

Примерный макет готового приложения на платформе Figma: [ссылка](https://www.figma.com/proto/YsaNCq6emYa44Ye9GBU04J/%D0%9C%D0%B0%D0%B3%D0%B0%D0%B7%D0%B8%D0%BD?node-id=6-35&t=I84OnMyHOC4VCTfX-0&scaling=min-zoom&content-scaling=fixed&page-id=0%3A1)

## Этапы разработки:
### Версия 0.1 (20.03.2025)
    * Создание классов для ORM.
 
### Версия 0.2 (28.03.2025)
    * Создание базового функционала сервера.
    * Создание скрипта для управления подключением к базе данных.

### Версия 0.4 (30.03.2025)
    * Создание главной страницы.
    * Создание страницы "О нас".
    * Создание страницы каталога.
    * Создание страницы "Производство".
    * Создание CSS файла.

### Версия 0.6 (09.04.2025)
    * Создание интерфейса взаимодействия консоли.
    * Добавление возможности регистрации администраторов через консоль.
    * Добавление возможности поиска администраторов через консоль.

### Версия 0.8 (28.04.2025)
    * Создание формы для входа.
    * Реализация возможности просматривать каталог.
    * Создание страниц администраторов.
    * Реализация входа администраторов.
    * Реализация возможности добавлять товары в каталог.
    * Реализация возможности добавлять и удалять товары из корзины.
    * Написание пояснительной записки.

### Версия 0.9 (08.05.2025)
    * Добавление возможности оформления заказа.
    * Создание презентации.

### Версия 1.0 (18.05.2025)
    * Всё остальное.
 
 



## <h2 id="links">Ссылки</h2>
* [Техническое задание (docx)](https://github.com/maxxximgb/magaz/raw/refs/heads/main/Documents/%D0%A2%D0%B5%D1%85%D0%BD%D0%B8%D1%87%D0%B5%D1%81%D0%BA%D0%BE%D0%B5%20%D0%B7%D0%B0%D0%B4%D0%B0%D0%BD%D0%B8%D0%B5.docx)
* [Пояснительная записка (docx)](/Documents/Пояснительная%20записка.docx)
* [Руководство пользователя (docx)](https://github.com/maxxximgb/magaz/raw/refs/heads/main/Documents/%D0%A0%D1%83%D0%BA%D0%BE%D0%B2%D0%BE%D0%B4%D1%81%D1%82%D0%B2%D0%BE%20%D0%BF%D0%BE%D0%BB%D1%8C%D0%B7%D0%BE%D0%B2%D0%B0%D1%82%D0%B5%D0%BB%D1%8F.docx)
* [Презентация (pptx)](/Documents/Презентация.pptx)

